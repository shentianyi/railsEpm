!function(Highcharts){var Chart=Highcharts.Chart,extend=(Highcharts.addEvent,Highcharts.extend),defaultOptions=Highcharts.getOptions();extend(defaultOptions.lang,{downloadDOC:"Download DOC",downloadDOCX:"Download DOCX",downloadPPT:"Download PPT",downloadPPTX:"Download PPTX",downloadXLS:"Download XLS",downloadXLSX:"Download XLSX"});var defaultExportButtonsData={png:{textKey:"downloadPNG",type:"image/png"},jpeg:{textKey:"downloadJPEG",type:"image/jpeg"},pdf:{textKey:"downloadPDF",type:"application/pdf"},docx:{textKey:"downloadDOCX",type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"},xlsx:{textKey:"downloadXLSX",type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},pptx:{textKey:"downloadPPTX",type:"application/vnd.openxmlformats-officedocument.presentationml.presentation"}},exportTableFileTypes=["xls","xlsx"],exportTableChartTypes=["line","column","scatter"],defaultExportButtons={chart:{textKey:"printChart",onclick:function(){this.print()}}};$.each(defaultExportButtonsData,function(key,value){defaultExportButtons[key]={textKey:value.textKey,onclick:function(){this.exportChart({type:key})}}}),extend(defaultOptions.exporting,{enableExtendExport:!0,exportTypes:["png"]}),extend(Chart.prototype,{addExportButton:function(){var exportingOptions=this.options.exporting,buttons=exportingOptions.buttons;if(exportingOptions.enableExtendExport){extend(buttons.contextButton,{menuItems:[]});for(var i=0;i<exportingOptions.exportTypes.length;i++)buttons.contextButton.menuItems.push(defaultExportButtons[exportingOptions.exportTypes[i]])}},exportChart:function(options,chartOptions){options=options||{};var chart=this,chartExportingOptions=chart.options.exporting,svg=chart.getSVG(Highcharts.merge({chart:{borderRadius:0}},chartExportingOptions.chartOptions,chartOptions,{exporting:{sourceWidth:options.sourceWidth||chartExportingOptions.sourceWidth,sourceHeight:options.sourceHeight||chartExportingOptions.sourceHeight}}));options=Highcharts.merge(chart.options.exporting,options);var table=null,tabled=-1!=exportTableFileTypes.indexOf(options.type)&&-1!=exportTableChartTypes.indexOf(chart.series[chart.series.length-1].type);tabled&&(table=chart.generateTableData()),Highcharts.post(options.url,{filename:options.filename||"chart",type:defaultExportButtonsData[options.type].type,width:options.width||0,scale:options.scale||2,svg:svg,muti:0,tabled:tabled,table:tabled?JSON.stringify(table):null})},generateTableData:function(){for(var table={series:[],rows:[],xAxis:{}},_xAxis={},i=0;i<this.series.length;i++)for(var data=this.series[i].data,j=0;j<data.length;j++)data[j].x in _xAxis||(_xAxis[data[j].x]=data[j].name);for(var _xAxisIndexs=Object.keys(_xAxis).sort(),i=0;i<_xAxisIndexs.length;i++)table.xAxis[_xAxisIndexs[i]]=_xAxis[_xAxisIndexs[i]];for(var i=0;i<this.series.length;i++){table.series.push(this.series[i].name),table.rows[i]={};for(var j=0;j<_xAxisIndexs.length;j++)table.rows[i][_xAxisIndexs[j]]=null;for(var data=this.series[i].data,j=0;j<data.length;j++)data[j].x in table.rows[i]&&(table.rows[i][data[j].x]=data[j].y)}return table}}),Highcharts.exportCharts=function(options,chartOptions){options=options||{};for(var charts=options.charts,svgs=[],chartExportingOptions=charts[0].options.exporting,i=0;i<charts.length;i++){var chart=charts[i],svg=chart.getSVG(Highcharts.merge({chart:{borderRadius:0}},chartExportingOptions.chartOptions,chartOptions,{exporting:{sourceWidth:options.sourceWidth||chartExportingOptions.sourceWidth,sourceHeight:options.sourceHeight||chartExportingOptions.sourceHeight}}));svgs.push(svg)}options=Highcharts.merge(chartExportingOptions,options),Highcharts.post(options.url,{filename:options.filename||"chart",type:defaultExportButtonsData[options.type].type,width:options.width||0,scale:options.scale||2,svg:svgs,muti:1,tabled:!1})},Chart.prototype.callbacks.unshift(function(chart){chart.addExportButton()})}(Highcharts);