function dashboard_add(){this.name="dashboard",this.href="../dashboards?p=",this.postHref="../dashboards"}function dashboard_delete(){this.url="../dashboards/",this.local="../dashboards",this.name="dashboard"}function dashboard_edit(){this.url="../dashboards/"}var right_nav_main=right_nav_main||{};right_nav_main.init=function(){right_nav_main.initial.name(),right_nav_main.item_prototype.add_init(),right_nav_main.item_prototype.delete_init(),right_nav_main.item_prototype.edit_init(),right_nav_main.observe_count.count=$("#content-right-nav-group").children().length,right_nav_main.current_section=$("#content-right-nav").attr("name"),right_nav_main.observe_count.observe()},right_nav_main.item_prototype={},right_nav_main.observe_count={observe:function(){0==this.count?($("#left-content-title").css("display","none"),$("#dashboard-content").css("display","none")):($("#left-content-title").css("display","block"),$("#dashboard-content").css("display","block"))}},right_nav_main.dashboard={},right_nav_main.initial={},right_nav_main.initial.name=function(){var name=$("#content-right-nav-group>li.active").find("a").text();$("#current-group-item").text(name),0==name.length&&($("#left-content-title").css("display","none"),$("#dashboard-content").css("display","none"))},right_nav_main.item_prototype.add=function(){},right_nav_main.item_prototype.add.prototype={add_show:function(){$("#content-right-nav-add-block").css("left","auto"),$("#content-right-nav-add-block>input").focus()},add_complete:function(){var validate=!1,name=$("#content-right-nav-add-block>input").val();if(0==$.trim(name).length)right_nav_main.item_prototype.add.prototype.add_hide();else if($("#content-right-nav-group>li").length>0?$("#content-right-nav-group>li").each(function(){return name==$(this).attr("title")?(validate=!1,!1):void(validate=!0)}):validate=!0,validate){var href=this.href;$.post(this.postHref,{data:{name:name}},function(data){data.result?($("#content-right-nav-group").append($("<li />").attr("title",name).attr("number",data.object).append($("<a href='"+href+data.object+"'/>").text(name)).append($("<i />").addClass("icon-remove"))),$("#content-right-nav-add-block>input").val(""),right_nav_main.item_prototype.add.prototype.add_hide(),right_nav_main.observe_count.count++,"dashboard"==right_nav_main.current_section&&($("#dashboard-group-name").append($("<option />").attr("value",data.object).text(name)),$("#dashboard-group-name").val("").trigger("chosen:updated"))):MessageBox(data.content,"top","warning")})}else MessageBox("Same name exist yet","top","warning")},add_hide:function(){$("#content-right-nav-add-block").css("left","-999em")},constructor:right_nav_main.item_prototype.add},dashboard_add.prototype=right_nav_main.item_prototype.add.prototype,dashboard_add.prototype.constructor=dashboard_add,right_nav_main.dashboard.add=new dashboard_add,right_nav_main.item_prototype.add_init=function(){$("#content-right-nav-add-button").on("click",function(){right_nav_main[right_nav_main.current_section].add.add_show()}),$("#content-right-nav-add-block>input").on("keydown",function(event){13==adapt_event(event).event.keyCode?0==$.trim($(adapt_event(event).target).val())?MessageBox("it needs a name","top","warning"):right_nav_main[right_nav_main.current_section].add.add_complete():27==adapt_event(event).event.keyCode&&right_nav_main[right_nav_main.current_section].add.add_hide()}).on("blur",function(){right_nav_main[right_nav_main.current_section].add.add_hide()})},right_nav_main.item_prototype.delete=function(){},right_nav_main.item_prototype.delete.prototype={delete_complete:function(e){var number=$(e.target).parent().attr("number"),local=this.local;$.ajax({url:this.url+number,type:"DELETE",success:function(data){data.result?(window.location.href=local,right_nav_main.observe_count.count--):MessageBox(data.content,"top","warning")}})},constructor:right_nav_main.item_prototype.delete},dashboard_delete.prototype=right_nav_main.item_prototype.delete.prototype,dashboard_delete.prototype.constructor=dashboard_delete,right_nav_main.dashboard.delete=new dashboard_delete,right_nav_main.item_prototype.delete_init=function(){$("#content-right-nav-group").on("click","i.icon-remove",function(event){if(confirm(I18n.t("manage.base.delete_confirm"))){var e=adapt_event(event).event;right_nav_main[right_nav_main.current_section].delete.delete_complete(e)}})},right_nav_main.item_prototype.edit=function(){},right_nav_main.item_prototype.edit.prototype={edit_show:function(e){var x=e.clientX-10,y=e.clientY-55,name=$("#left-content-title>p").text();$("#content-left-content-edit-block").css("left",x).css("top",y),$("#content-left-content-edit-block>input").val(name).focus()},edit_check:function(e){var validate=!0;return $(e.target).val()==$("#content-right-nav-group>li.active").attr("title")?(this.edit_hide(),!1):($("#content-right-nav-group>li").each(function(){return $(this).attr("title")==$(e.target).val()?(validate=!1,MessageBox("Same name exist yet","top","warning"),!1):void 0}),validate)},edit_update:function(){var id=$("#content-right-nav-group>li.active").attr("number"),name=$("#content-left-content-edit-block>input").val();$.ajax({url:this.url+id,type:"PUT",data:{id:id,data:{name:name}},success:function(data){data&&($("#content-right-nav-group>li.active>a").text(name),$("#current-group-item").text(name),$("#content-right-nav-group>li.active").attr("title",name))}}),this.edit_hide()},edit_hide:function(){$("#content-left-content-edit-block").css("left","-999em")},constructor:right_nav_main.item_prototype.edit},dashboard_edit.prototype=right_nav_main.item_prototype.edit.prototype,dashboard_edit.prototype.constructor=dashboard_edit,right_nav_main.dashboard.edit=new dashboard_edit,right_nav_main.item_prototype.edit_init=function(){$("body").on("click","#current-group-item-edit",function(event){var e=adapt_event(event).event;right_nav_main[right_nav_main.current_section].edit.edit_show(e)}),$("#content-left-content-edit-block").on("keydown","input",function(event){var e=adapt_event(event).event;13==e.keyCode?0==$.trim($(e.target).val())?MessageBox("please don't leave it empty","top","warning"):right_nav_main[right_nav_main.current_section].edit.edit_check(e)&&right_nav_main[right_nav_main.current_section].edit.edit_update():27==e.keyCode&&right_nav_main[right_nav_main.current_section].edit.edit_hide()}).on("blur","input",function(){right_nav_main[right_nav_main.current_section].edit.edit_hide()}),$("#content-left-content-edit-block").on("click","input",function(event){stop_propagation(event)})};