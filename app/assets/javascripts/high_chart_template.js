function render_to(option){high_chart.chart.renderTo=option.target,Highcharts.dateFormats={W:function(timestamp){var d=new Date(timestamp);d.setHours(0,0,0),d.setDate(d.getDate()+4-(d.getDay()||7));var yearStart=new Date(d.getFullYear(),0,1),weekNo=Math.ceil(((d-yearStart)/864e5+1)/7);return weekNo},Q:function(timestamp){var d=new Date(timestamp);return d.monthToQuarter()},YW:function(timestamp){var d=new Date(timestamp);return d.setHours(0,0,0),d.setDate(d.getDate()+4-(d.getDay()||7)),d.getFullYear()}},null!=option.theme?HIGH_CHART.theme[option.theme]():HIGH_CHART.theme["default"]()}function add_series(option){var series_name=option.kpi,series_id=option.id,chart_container=option.target,data=(option.type,deal_data(option)),color=option.color?option.color:option.theme?HIGH_CHART.chart_color[option.theme][series_id%HIGH_CHART.chart_color[option.theme].length]:HIGH_CHART.chart_color["default"][series_id%HIGH_CHART.chart_color["default"].length];$("#"+chart_container).highcharts().addSeries({name:series_name,id:series_id,color:color,data:data})}function set_data(option){this.date=option.begin_time?standardParse(option.begin_time).date:null,this.template=option.begin_time?standardParse(option.begin_time).template:null,this.data=option.data?option.data:null,this.chart_container=option.target?option.target:null,this.chart=option.target?$("#"+option.target).highcharts():null,this.series_id=null!==option.id?option.id:null,this.type=option.type?option.type:null,this.interval=option.interval?option.interval:null,this.id=null!==option.id?option.id:null,this.count=option.count?option.count:null,this.theme=option.theme?option.theme:null,this.view=option.view_text?option.view_text:null,this.kpi_name=option.kpi?option.kpi:null}function deal_data(){set_data.apply(this,arguments);var i,data=this.data;switch(this.interval){case"90":for(i=0;i<data.length;i++)data[i].x=Date.UTC(this.template[0],this.template[1],this.template[2],parseInt(this.template[3])+i),data[i].name=new Date(this.template[0],this.template[1],this.template[2],parseInt(this.template[3])+i).toWayneString().hour,data[i].view=this.view;return data;case"100":for(i=0;i<this.data.length;i++)this.data[i].x=Date.UTC(this.template[0],this.template[1],parseInt(this.template[2])+i),this.data[i].name=new Date(this.template[0],this.template[1],parseInt(this.template[2])+i).toWayneString().day,this.data[i].view=this.view;return data;case"200":for(i=0;i<this.data.length;i++){var week_template=standardParse(last_date_of_week(Date.UTC(this.template[0],this.template[1],parseInt(this.template[2])+7*i)).date.toWayneString().day).template;this.data[i].x=Date.UTC(week_template[0],week_template[1],week_template[2]),this.data[i].name=new Date(this.template[0],this.template[1],parseInt(this.template[2])+7*i).toWayneString().day+" week"+new Date(this.template[0],this.template[1],parseInt(this.template[2])+7*i).toWeekNumber(),this.data[i].view=this.view}return data;case"300":for(i=0;i<this.data.length;i++)this.data[i].x=Date.UTC(this.template[0],parseInt(this.template[1])+i),this.data[i].name=new Date(this.template[0],parseInt(this.template[1])+i).toWayneString().month,this.data[i].view=this.view;return data;case"400":for(i=0;i<this.data.length;i++){var first_month_of_quarter=3*Math.floor(parseInt(this.template[1])/3);this.data[i].x=Date.UTC(this.template[0],first_month_of_quarter+3*i),this.data[i].name=new Date(this.template[0],parseInt(this.template[1])+3*i).getFullYear()+" quarter "+new Date(this.template[0],parseInt(this.template[1])+3*i).monthToQuarter(),this.data[i].view=this.view}return data;case"500":for(i=0;i<this.data.length;i++)this.data[i].x=Date.UTC(parseInt(this.template[0])+i,0),this.data[i].name=new Date(parseInt(this.template[0])+i,0).toWayneString().year,this.data[i].view=this.view;return data}}function create_environment_for_data(){set_data.apply(this,arguments);var i,j;switch(this.interval){case"90":high_chart.xAxis.tickPositioner=function(){var extreme=[];for(i=0;i<this.chart.series.length;i++)for(j=0;j<this.chart.series[i].processedXData.length;j++)extreme.push(this.chart.series[i].processedXData[j]);return extreme.info={unitName:"hour",higherRanks:{}},extreme};break;case"100":high_chart.xAxis.tickPositioner=function(){var extreme=[];for(i=0;i<this.chart.series.length;i++)for(j=0;j<this.chart.series[i].processedXData.length;j++)extreme.push(this.chart.series[i].processedXData[j]);return extreme.info={unitName:"day",higherRanks:{}},extreme};break;case"200":high_chart.xAxis.tickPositioner=function(){var extreme=[];for(i=0;i<this.chart.series.length;i++)for(j=0;j<this.chart.series[i].processedXData.length;j++)extreme.push(this.chart.series[i].processedXData[j]);return extreme.info={unitName:"week",higherRanks:{}},extreme};break;case"300":high_chart.xAxis.tickPositioner=function(){var extreme=[];for(i=0;i<this.chart.series.length;i++)for(j=0;j<this.chart.series[i].processedXData.length;j++)extreme.push(this.chart.series[i].processedXData[j]);return extreme.info={unitName:"month",higherRanks:{}},extreme};break;case"400":high_chart.xAxis.tickPositioner=function(){var extreme=[];for(i=0;i<this.chart.series.length;i++)for(j=0;j<this.chart.series[i].processedXData.length;j++)extreme.push(this.chart.series[i].processedXData[j]);return extreme.info={unitName:"millisecond",higherRanks:{}},extreme};break;case"500":high_chart.xAxis.tickPositioner=function(){var extreme=[];for(i=0;i<this.chart.series.length;i++)for(j=0;j<this.chart.series[i].processedXData.length;j++)extreme.push(this.chart.series[i].processedXData[j]);return extreme.info={unitName:"year",higherRanks:{}},extreme}}}function proper_type_for_chart(){if(set_data.apply(this,arguments),"pie"==this.type){if(this.chart.get("pie_extra_series")){this.chart.get("pie_extra_series").remove();for(var k=0;k<this.chart.series.length;k++)this.chart.series[k].update({showInLegend:!0},!1);this.chart.legend.group.show(),this.chart.legend.box.show(),this.chart.legend.display=!0}var dataItem,dataItemValue,dataItemTarget,chart_name,chart_color,data=[];if(1==this.count){this.chart.series[0].show();for(var max_data,index,i=0;i<this.chart.series[0].processedYData.length;i++)dataItem={},dataItem.name=this.chart.series[0].data[i].name,dataItem.y=this.chart.series[0].processedYData[i],dataItem.high=this.chart.series[0].data[i].high,dataItem.low=this.chart.series[0].data[i].low,dataItem.unit=this.chart.series[0].data[i].unit,0==i?(max_data=dataItem.y,index=0):dataItem.y>max_data&&(max_data=dataItem.y,index=i),data.push(dataItem);data[index].sliced=!0,data[index].selected=!0,chart_name=this.chart.series[0].name,this.chart.series[0].hide()}else{chart_name=[];for(var max_data,index,i=0;i<this.count;i++){this.chart.series[i].show(),dataItem={},dataItemValue=0,dataItemTarget=0,dataItem.name=this.chart.series[i].name+"<br />From:"+this.chart.series[i].data[0].name+"<br />To:"+this.chart.series[i].data[this.chart.series[i].data.length-1].name;for(var j=0;j<this.chart.series[i].processedYData.length;j++)dataItemValue+=this.chart.series[i].processedYData[j];dataItem.kpi_name=this.chart.series[i].name,dataItem.y=dataItemValue,dataItem.seriesId=this.chart.series[i].data[0].id,chart_name.push(this.chart.series[i].name),dataItem.average_y=(dataItemValue/this.chart.series[i].processedYData.length).toFixed(2),dataItem.time_from=this.chart.series[i].data[0].name,dataItem.time_to=this.chart.series[i].data[this.chart.series[i].data.length-1].name,dataItem.unit=this.chart.series[i].data[0].unit,dataItem.color=this.theme?HIGH_CHART.chart_color[this.theme][dataItem.seriesId%HIGH_CHART.chart_color[this.theme].length]:HIGH_CHART.chart_color["default"][dataItem.seriesId%HIGH_CHART.chart_color["default"].length],0==i?(max_data=dataItem.y,index=0):dataItem.y>max_data&&(max_data=dataItem.y,index=i),data.push(dataItem),data[index].sliced=!0,data[index].selected=!0,this.chart.series[i].hide()}}this.chart.addSeries({name:chart_name,id:"pie_extra_series",color:chart_color,data:data,type:"pie"},!0),this.chart.redraw(),this.chart.legend.group.hide(),this.chart.legend.box.hide(),this.chart.legend.display=!1}else{if(this.chart.get("pie_extra_series")){this.chart.get("pie_extra_series").remove();for(var k=0;k<this.chart.series.length;k++)this.chart.series[k].update({showInLegend:!0},!1);this.chart.legend.group.show(),this.chart.legend.box.show(),this.chart.legend.display=!0}var c,obj=this,name=null===obj.kpi_name?this.chart.get(this.id).options.name:obj.kpi_name+"("+obj.view+")",p={name:name,id:this.chart.get(this.id).options.id,color:this.chart.get(this.id).color,data:this.chart.get(this.id).options.data},new_series=deepCopy(p,c);if("column"==this.type)for(var i=0;i<new_series.data.length;i++)new_series.data[i].target_min=new_series.data[i].low,new_series.data[i].low=0;else if(void 0!==new_series.data[0].target_min)for(var i=0;i<new_series.data.length;i++)new_series.data[i].low=new_series.data[i].target_min;new_series.type=this.type,this.chart.get(this.id).remove(!1),this.chart.addSeries(new_series,!1),this.chart.redraw()}}function pie_for_dashboard(container){var option={target:container,type:"pie",count:$("#"+container).highcharts().series.length-1};proper_type_for_chart(option)}function limit_pointer_number(){set_data.apply(this,arguments),this.chart.xAxis[0].tickPositions.length>9&&limit_pointer_condition["_"+this.interval].limitAction(this.chart)}function deal_extreme(chart){var extreme=[],i=0,length=chart.series[i].processedXData.length,half=Math.floor(length/2),first_half=Math.floor(length/4),last_half=Math.floor((length-1+half)/2),first_half_quarter_first=Math.floor(first_half/2),first_half_quarter_second=Math.floor((first_half+half)/2),last_half_quarter_first=Math.floor((half+last_half)/2),last_half_quarter_second=Math.floor((last_half+length)/2);return extreme.push(chart.series[i].processedXData[0]),extreme.push(chart.series[i].processedXData[first_half_quarter_first]),extreme.push(chart.series[i].processedXData[first_half]),extreme.push(chart.series[i].processedXData[first_half_quarter_second]),extreme.push(chart.series[i].processedXData[half]),extreme.push(chart.series[i].processedXData[last_half_quarter_first]),extreme.push(chart.series[i].processedXData[last_half]),extreme.push(chart.series[i].processedXData[last_half_quarter_second]),extreme.push(chart.series[i].processedXData[length-1]),extreme}var HIGH_CHART=HIGH_CHART||{},url="http://42.121.111.38:9002/HighChartsFileService/",high_chart={chart:{spacingLeft:5,spacingRight:5,spacingBottom:1,marginTop:0,borderRadius:0,animation:{duration:800}},title:{text:null},credits:{enabled:!1},tooltip:{formatter:function(){return"pie"!=this.series.type?"column"==this.series.type?"<b>"+this.point.name+'</b><br />KPI: <span style="color:'+this.series.color+'">'+this.series.name+"</span><br />"+I18n.t("chart.view")+": "+this.point.view+"<br />"+I18n.t("chart.value")+" : "+this.y+" "+this.point.unit+"<br />"+I18n.t("chart.target_range")+": "+this.point.target_min+"-"+this.point.high:"<b>"+this.point.name+'</b><br />KPI: <span style="color:'+this.series.color+'">'+this.series.name+"</span><br />"+I18n.t("chart.view")+": "+this.point.view+"<br />"+I18n.t("chart.value")+": "+this.y+" "+this.point.unit+"<br />"+I18n.t("chart.target_range")+": "+this.point.low+"-"+this.point.high:"<b>"+this.point.name+'</b><br />KPI: <span style="color:'+this.series.color+'">'+this.series.name+"</span><br />"+I18n.t("chart.view")+": "+this.point.view+"<br />"+I18n.t("chart.value")+": "+this.y+" "+this.point.unit+"<br />"+I18n.t("chart.percent")+": "+this.percentage.toFixed(1)+"%"}},legend:{enabled:!0,borderRadius:2,borderColor:"rgba(0,0,0,0)",animation:!0,maxHeight:40,margin:0,itemMarginBottom:-2},exporting:{buttons:{contextButton:{symbol:"url(/assets/down.png)",y:0}},url:url,filename:"MyChart",width:700,exportTypes:["chart","png","jpeg","pdf","docx","pptx","xlsx"]},plotOptions:{series:{animation:{duration:1e3},cursor:"pointer",marker:{enabled:!0,fillColor:null,lineColor:null,states:{select:{fillColor:null,lineColor:"white"}}},turboThreshold:1e4,states:{select:{color:null,borderColor:null}},events:{}},arearange:{fillOpacity:.1,fillColor:"rgba(177,211,221,0.2)",lineColor:"rgba(177,211,221,0)",lineWidth:0,color:"rgba(177,211,221,0.2)",stickyTracking:!1,trackByArea:!1,zIndex:-1,showInLegend:!1},line:{lineWidth:3,showInLegend:!1,marker:{lineWidth:2,radius:1,symbol:"diamond"},events:{mouseOver:function(){this.data.length>1&&this.graph.attr("zIndex",99)},mouseOut:function(){this.data.length>1&&this.graph.attr("zIndex",this.index)}}},column:{borderColor:null},pie:{size:"70%",allowPointSelect:!0,cursor:"pointer",dataLabels:{connectorWidth:1,format:"<b>{point.name}</b><br />{point.percentage:.1f} %"},point:{events:{select:function(){var name,$table=$("#"+this.series.chart.renderTo.id).prev(".dashboard-item-extra-info");$table.find(".percentage").text(this.percentage.toFixed(1)+"%"),name=this.series.chart.series.length>2?this.kpi_name:this.name,$table.find(".pie-selected-name").text(name),$table.find(".selected-value").text(this.y+this.unit)}}},events:{click:function(){var i,$table=$("#"+this.chart.renderTo.id).prev(".dashboard-item-extra-info"),total=0;for(i=0;i<this.data.length;i++)total+=this.data[i].y;$table.find(".pie-total-value").text(total+this.data[0].unit)}}},scatter:{marker:{radius:4,symbol:"circle"}}},xAxis:{lineWidth:0,tickWidth:0,ordinal:!0,minPadding:.02,maxPadding:.02,minRange:36e5,type:"datetime",dateTimeLabelFormats:{millisecond:"quarter %Q<br />%Y",hour:"%H:%M<br />%e/%b",day:"%e<br />%b",week:"Week<br />%W",month:"%b<br />%Y",year:"%Y"}},yAxis:{offset:-25,showFirstLabel:!1,min:0,title:{enabled:!1},labels:{y:-2}}},limit_pointer_condition={limit:9,_90:{limit:9,limitAction:function(chart){chart.xAxis[0].update({tickPositioner:function(){var extreme=deal_extreme(chart);return extreme.info={unitName:"hour",higherRanks:{}},extreme}})}},_100:{limit:9,limitAction:function(chart){chart.xAxis[0].update({tickPositioner:function(){var extreme=deal_extreme(chart);return extreme.info={unitName:"day",higherRanks:{}},extreme}})}},_200:{limit:9,limitAction:function(chart){chart.xAxis[0].update({tickPositioner:function(){var extreme=deal_extreme(chart);return extreme.info={unitName:"week",higherRanks:{}},extreme}})}},_300:{limit:9,limitAction:function(chart){chart.xAxis[0].update({tickPositioner:function(){var extreme=deal_extreme(chart);return extreme.info={unitName:"month",higherRanks:{}},extreme}})}},_400:{limit:9,limitAction:function(chart){chart.xAxis[0].update({tickPositioner:function(){var extreme=deal_extreme(chart);return extreme.info={unitName:"millisecond",higherRanks:{}},extreme}})}},_500:{limit:9,limitAction:function(chart){chart.xAxis[0].update({tickPositioner:function(){var extreme=deal_extreme(chart);return extreme.info={unitName:"year",higherRanks:{}},extreme}})}}};HIGH_CHART.postPrepare=function(begin_time,interval){var template=standardParse(begin_time).template;switch(interval){case"90":return new Date(template[0],template[1],template[2],template[3]);case"100":return new Date(template[0],template[1],template[2]);case"200":return 0==standardParse(begin_time).date.getDay()?new Date(template[0],template[1],+template[2]-6):new Date(template[0],template[1],+template[2]-standardParse(begin_time).date.getDay()+1);case"300":return new Date(template[0],template[1]);case"400":return new Date(template[0],3*Math.floor(+template[1]/3));case"500":return new Date(template[0],0)}};